<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shopping Cart - ETCETRA</title>
<link rel="stylesheet" href="styles.css">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
<div class="site-wrapper">
<!-- Header -->
<header class="header">
  <div class="container">
    <div class="header-content">
      <div class="header-left">
        <button class="menu-button" id="menuButton" aria-label="Toggle menu">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
          </svg>
        </button>
        <a href="index.html" class="logo">ETCETRA</a>
        <nav class="desktop-nav">
          <a href="index.html" class="nav-link">Home</a>
          <a href="products.html" class="nav-link">Products</a>
          <a href="about.html" class="nav-link">About</a>
          <a href="contact.html" class="nav-link">Contact</a>
        </nav>
      </div>
      <div class="header-search">
        <div class="search-container">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
          </svg>
          <input type="search" placeholder="Search..." class="search-input">
        </div>
      </div>
      <div class="header-actions">
        <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="sun-icon">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="moon-icon">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
        </button>
      </div>
    </div>
  </div>
</header>

<!-- Mobile Menu -->
<div class="mobile-menu" id="mobileMenu">
  <div class="mobile-menu-container">
    <div class="mobile-menu-header">
      <span class="logo">ETCETRA</span>
      <button class="close-menu" id="closeMenu" aria-label="Close menu">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    <nav class="mobile-nav">
      <a href="index.html" class="mobile-nav-link">Home</a>
      <a href="products.html" class="mobile-nav-link">Products</a>
      <a href="about.html" class="mobile-nav-link">About</a>
      <a href="contact.html" class="mobile-nav-link">Contact</a>
    </nav>
  </div>
</div>

<!-- Main Content -->
<main>
  <div class="container">
    <div class="back-link">
      <a href="products.html" class="text-link">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="19" y1="12" x2="5" y2="12"></line>
          <polyline points="12 19 5 12 12 5"></polyline>
        </svg>
        Continue shopping
      </a>
    </div>
    
    <div class="page-header">
      <h1>Your Cart</h1>
      <p>Review your items before checkout</p>
    </div>
    
    <div class="cart-container">
      <div class="cart-items">
        <!-- Cart items will be loaded via JavaScript -->
      </div>
    
      <div class="cart-summary">
        <!-- Cart summary will be loaded via JavaScript -->
      </div>
    
      <div class="delivery-section" style="margin-top: 30px;">
        <h2>Delivery Address</h2>
        <form id="deliveryForm">
          <div>
            <label for="name">Full Name</label><br />
            <input type="text" id="name" name="name" required />
          </div>
    
          <div>
            <label for="phone">Phone Number</label><br />
            <input type="tel" id="phone" name="phone" pattern="[0-9]{10}" required />
          </div>
    
          <div>
            <label for="address">Address</label><br />
            <textarea id="address" name="address" rows="3" required></textarea>
          </div>
    
          <div>
            <label for="city">City</label><br />
            <input type="text" id="city" name="city" required />
          </div>
    
          <div>
            <label for="state">State</label><br />
            <input type="text" id="state" name="state" required />
          </div>
    
          <div>
            <label for="pincode">Pincode</label><br />
            <input type="text" id="pincode" name="pincode" pattern="[0-9]{6}" required />
          </div>
    
          <button type="submit" class="button primary" id="proceedToPayment" style="margin-top: 10px;">Place Order</button>
        </form>
      </div>
    </div>
    
    
    <div class="empty-cart" style="display: none;">
      <div class="empty-cart-content">
        <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <path d="M16 10a4 4 0 0 1-8 0"></path>
        </svg>
        <h2>Your cart is empty</h2>
        <p>Looks like you haven't added any items to your cart yet.</p>
        <a href="products.html" class="button primary">Start Shopping</a>
      </div>
    </div>
    
    
    <!-- FAQ section moved below products -->
    <div class="cart-faq">
      <h3>Frequently Asked Questions</h3><br>
      <div class="faq-item">
        <div class="faq-question">
          <span>How long does shipping take?</span>
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </div>
        <div class="faq-answer">
          <p>Standard shipping typically takes 3-5 business days. Express shipping is available for 1-2 business day delivery. International shipping may take 7-14 business days depending on the destination.</p>
        </div>
      </div>
      <div class="faq-item">
        <div class="faq-question">
          <span>What is your return policy?</span>
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </div>
        <div class="faq-answer">
          <p>We offer a 30-day return policy. Items must be unworn, unwashed, and with the original tags attached. Return shipping is free for domestic orders.</p>
        </div>
      </div>
      <div class="faq-item">
        <div class="faq-question">
          <span>How do I apply a coupon code?</span>
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </div>
        <div class="faq-answer">
          <p>You can apply a coupon code in the cart by entering it in the "Enter promo code" field and clicking "Apply". The discount will be automatically applied to your order.</p>
        </div>
      </div>
      <div class="faq-item">
        <div class="faq-question">
          <span>Do you offer international shipping?</span>
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </div>
        <div class="faq-answer">
          <p>Yes, we ship to most countries worldwide. International shipping rates and delivery times vary by location. Any applicable customs fees or import duties are the responsibility of the customer.</p>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- Footer -->
<footer class="footer">
  <div class="container">
    <div class="footer-content">
      <div class="footer-links">
        <div class="footer-column">
          <h3 class="footer-heading">Shop</h3>
          <ul class="footer-list">
            <li><a href="products.html">All Products</a></li>
            <li><a href="products.html">Oversized Tees</a></li>
            <li><a href="products.html">New Arrivals</a></li>
            <li><a href="products.html">Best Sellers</a></li>
          </ul>
        </div>
        <div class="footer-column">
          <h3 class="footer-heading">Company</h3>
          <ul class="footer-list">
            <li><a href="about.html">About Us</a></li>
            <li><a href="contact.html">Contact</a></li>
            <li><a href="terms.html">Terms of Service</a></li>
            <li><a href="privacy.html">Privacy Policy</a></li>
          </ul>
        </div>
        <div class="footer-column">
          <h3 class="footer-heading">Account</h3>
          <ul class="footer-list">
            <li><a href="login.html">Login</a></li>
            <li><a href="register.html">Register</a></li>
            <li><a href="profile.html">My Account</a></li>
            <li><a href="orders.html">Order History</a></li>
          </ul>
        </div>
        <div class="footer-column">
          <h3 class="footer-heading">Customer Care</h3>
          <ul class="footer-list">
            <li><a href="faqs.html">FAQs</a></li>
            <li><a href="shipping.html">Shipping Info</a></li>
            <li><a href="returns.html">Returns & Exchanges</a></li>
            <li><a href="size-guide.html">Size Guide</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        <p class="copyright">
          © <span id="currentYear"></span> ETCETRA. All rights reserved.
        </p>
        <div class="social-links">
          <a href="#" class="social-link">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
            </svg>
          </a>
          <a href="#" class="social-link">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
              <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
              <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
            </svg>
          </a>
          <a href="#" class="social-link">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0  stroke-linejoin="round">
              <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
            </svg>
          </a>
        </div>
      </div>
    </div>
  </div>
</footer>
</div>

<script src="script.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const cartItemsContainer = document.querySelector('.cart-items');
    const cartSummaryContainer = document.querySelector('.cart-summary');
    const emptyCart = document.querySelector('.empty-cart');

    const cartItems = JSON.parse(localStorage.getItem('cart')) || [];

    // Function to update cart in local storage
    function updateCart() {
      localStorage.setItem('cart', JSON.stringify(cartItems));
      renderCart();
    }

    // Function to render the cart
    function renderCart() {
      if (cartItems.length === 0) {
        emptyCart.style.display = 'block';
        cartItemsContainer.innerHTML = '';
        cartSummaryContainer.innerHTML = '';
        return;
      }

      emptyCart.style.display = 'none';
      cartItemsContainer.innerHTML = '';
      let total = 0;

      cartItems.forEach((item, index) => {
        total += item.price * item.quantity;
        const itemElement = document.createElement('div');
        itemElement.classList.add('cart-item');
        itemElement.innerHTML = `
          <div class="item-image">
            <img src="${item.image}" alt="${item.name}" style="height: auto; width: 100px; object-fit: cover; " class="product-image">
          </div>
          <div class="item-details">
            <span class="item-name">${item.name}</span>
            <span class="item-price">₹${item.price}</span>
            
            <!-- Displaying selected size -->
            <span class="item-size">Size: ${item.size}</span>

            <div class="quantity-controls">
              <button class="decrease-quantity" data-index="${index}">-</button>
              <span class="item-quantity">${item.quantity}</span>
              <button class="increase-quantity" data-index="${index}">+</button>
            </div>
            <button class="remove-item" data-index="${index}">Remove</button>
          </div>
        `;
        cartItemsContainer.appendChild(itemElement);
      });

      cartSummaryContainer.innerHTML = `
        <div class="summary-details">
          <span>Total: ₹${total}</span>
        </div>
      `;

      // Add event listeners for increase/decrease/remove actions
      const increaseButtons = document.querySelectorAll('.increase-quantity');
      const decreaseButtons = document.querySelectorAll('.decrease-quantity');
      const removeButtons = document.querySelectorAll('.remove-item');

      increaseButtons.forEach(button => {
        button.addEventListener('click', () => {
          const index = button.getAttribute('data-index');
          cartItems[index].quantity++;
          updateCart();
        });
      });

      decreaseButtons.forEach(button => {
        button.addEventListener('click', () => {
          const index = button.getAttribute('data-index');
          if (cartItems[index].quantity > 1) {
            cartItems[index].quantity--;
            updateCart();
          }
        });
      });

      removeButtons.forEach(button => {
        button.addEventListener('click', () => {
          const index = button.getAttribute('data-index');
          cartItems.splice(index, 1);  // Remove item from array
          updateCart();
        });
      });
    }

    renderCart();
  });
</script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const deliveryForm = document.getElementById("deliveryForm");

    deliveryForm.addEventListener("submit", function (e) {
      e.preventDefault();

      const userData = {
        name: document.getElementById("name").value.trim(),
        phone: document.getElementById("phone").value.trim(),
        address: document.getElementById("address").value.trim(),
        city: document.getElementById("city").value.trim(),
        state: document.getElementById("state").value.trim(),
        pincode: document.getElementById("pincode").value.trim()
      };

      if (!/^\d{10}$/.test(userData.phone)) {
        alert("Please enter a valid 10-digit phone number.");
        return;
      }

      if (!/^\d{6}$/.test(userData.pincode)) {
        alert("Please enter a valid 6-digit pincode.");
        return;
      }

      localStorage.setItem("deliveryInfo", JSON.stringify(userData));

      deliveryForm.reset();

      // Optional: redirect or show confirmation
      // window.location.href = "/thank-you.html";
    });
  });
</script>

<script>
  document.getElementById("proceedToPayment").addEventListener("click", async function () {
  const cartItems = JSON.parse(localStorage.getItem("cart")) || [];
  const deliveryInfo = JSON.parse(localStorage.getItem("deliveryInfo")) || {};

  if (cartItems.length === 0) {
    alert("Your cart is empty.");
    return;
  }

  // Total calculation
  const totalAmount = cartItems.reduce((sum, item) => {
    return sum + item.price * item.quantity;
  }, 0);

  const orderData = {
    cartItems,
    address: deliveryInfo,
    totalAmount
  };

  try {
    const response = await fetch("/api/v1/users/order", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        // Optional: add token if using auth middleware
        "Authorization": `Bearer ${localStorage.getItem("token")}`
      },
      body: JSON.stringify(orderData),
      credentials: "include",
    });

    const data = await response.json();
    if(data.redirect){
      window.location.href = data.redirect;
    return;
    }
    if (data.success) {
      alert("Order placed successfully. Redirecting to payment...");
      // Clear cart after order is placed
      localStorage.removeItem("cart");
      localStorage.removeItem("deliveryInfo");

      // Redirect to payment
      window.location.href = data.redirectUrl;  // e.g., /payment/:orderId
    } else {
      alert("Order failed: " + data.message);
    }

  } catch (error) {
    console.error("Error:", error);
    alert("An error occurred while placing the order.");
  }
});

</script>


</body>
</html>

